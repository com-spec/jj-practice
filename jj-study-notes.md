# Jujutsu (jj) 学習メモ

## Jujutsuとは

gitに代わるバージョン管理ツール。既存のgitリポジトリと互換性があり、併用可能。

## 初期設定

### 既存のgitリポジトリでjjを使う場合

```bash
jj git init
```

**重要：初期化は1回だけでOK！**
- `.jj/` ディレクトリが作成される
- 既存の `.git/` はそのまま残る
- 以降、そのディレクトリでずっとjjが使える

## gitとの主な違い

### 1. 作業の考え方

**git:**
```
作業ツリー → ステージング → コミット
```

**jj:**
```
常にコミットの上で作業（ステージング不要）
```

### 2. コマンドの対応

| やりたいこと | git | jj |
|------------|-----|-----|
| 状態確認 | `git status` | `jj status` |
| 履歴表示 | `git log` | `jj log` |
| 変更内容確認 | `git diff` | `jj diff` |
| コミット | `git add` + `git commit -m "..."` | `jj describe -m "..."` |
| 次の作業開始 | （自動） | `jj new` |

## 基本的なワークフロー

### 1. ファイルを変更する
```bash
# ファイルを作成・編集
# → 自動的に現在のコミット (@) に反映される
```

### 2. 状態を確認
```bash
jj status
# Working copy changes:
# A test.txt  ← 追加されたファイル
```

### 3. コミットメッセージを設定
```bash
jj describe -m "test.txtを追加"
```

### 4. 変更を確定して次の作業へ
```bash
jj new
# → 現在の変更が確定（親コミットになる）
# → 新しい空のコミットで作業開始
```

## 重要な概念

### `@` マーク
- 現在の作業コピー（working copy）を表す
- 常にこのコミット上で作業している

### `jj new` の意味
- **gitの`commit`に相当**
- 現在の作業を一区切りにして、新しいコミットを開始
- 実行前：`@` で作業中
- 実行後：以前の `@` が `○`（確定）になり、新しい `@` が作られる

### ステージングエリアがない
- `git add` が不要
- ファイルを変更すると自動的に追跡される
- コミットメッセージは後から設定できる（`jj describe`）

## jjの記号の意味

```
@  現在の作業コピー（working copy）
○  通常のコミット
◆  ブックマーク（ブランチ）があるコミット
│  履歴の線
~  さらに古い履歴があることを示す
```

## 実際に試したこと

1. `jj git init` でjjを初期化
2. [test.txt](test.txt) を作成 → 自動的に追跡された
3. `jj status` で状態確認 → `A test.txt`
4. `jj diff` で変更内容確認
5. `jj describe -m "test.txtを追加"` でメッセージ設定
6. `jj new` で変更を確定し、新しい作業開始

## jjのメリット

### 手動操作の場合
- コミット後でもメッセージを簡単に編集できる
- ステージングを気にしなくていい
- `jj undo` で簡単に元に戻せる
- 作業の流れが直感的

### Claude Codeを使う場合
- メリットは限定的
- Claude Codeが既にgitを適切に扱えるため
- 手動で履歴を編集したい時には便利

## 参考コマンド

```bash
# 状態確認
jj status

# 履歴表示
jj log

# 変更内容確認
jj diff

# コミットメッセージ設定
jj describe -m "メッセージ"

# 変更を確定して次へ
jj new

# 操作を取り消す
jj undo
```

## まとめ

- jjは「常にコミット上で作業する」という新しい発想
- `git add` や `git commit` の2段階が不要
- `jj new` = gitの「コミット地点」
- 手動操作では便利だが、Claude Codeでは差が小さい
- 練習用や個人プロジェクトで試すのに最適
